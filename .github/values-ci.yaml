# CI-specific values for the Archestra Helm chart
# This file is used during acceptance testing in GitHub Actions
# Note: e2e test dependencies (WireMock, Keycloak) are NOT included here
# as they are not needed for Terraform provider acceptance tests

archestra:
  # Use latest image
  image: archestra/platform:latest

  # Environment variables for acceptance testing
  env:
    # Point to real LLM APIs (or mock as needed)
    # For acceptance tests, we can skip these as the provider tests
    # don't actually call LLM endpoints
    ARCHESTRA_METRICS_SECRET: "acceptance-test-metrics-secret"
    ARCHESTRA_FRONTEND_URL: "http://localhost:3000"
    ARCHESTRA_AUTH_SECRET: "acceptance-test-auth-secret-32chars"
    # Enable test MCP server seeding (useful for acceptance tests)
    ENABLE_TEST_MCP_SERVER: "true"

  # Use NodePort service type to expose services on fixed ports
  service:
    type: NodePort
    nodePorts:
      backend: 30000
      metrics: 30050
      frontend: 30300

# PostgreSQL configuration for CI
postgresql:
  # Use the internal PostgreSQL instance
  external_database_url: null
  enabled: true
  auth:
    database: archestra_dev
    username: archestra
    password: archestra_dev_password
  # Use NodePort to expose PostgreSQL for debugging if needed
  primary:
    service:
      type: NodePort
      nodePorts:
        postgresql: 30432
