---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "archestra_profile_tool Resource - archestra"
subcategory: ""
description: |-
  Assigns a tool to an Archestra Profile and configures its execution and security policies.
---

# archestra_profile_tool (Resource)

Assigns a tool to an Archestra Profile and configures its execution and security policies.

## Example Usage

```terraform
# =============================================================================
# Example 1: Assign a built-in tool to a profile
# =============================================================================

# Create a Profile
resource "archestra_profile" "demo_profile" {
  name = "Demo Profile"
}

# Look up the built-in 'whoami' tool
data "archestra_profile_tool" "whoami" {
  tool_name  = "archestra__whoami"
  profile_id = archestra_profile.demo_profile.id
}

# Assign the Tool to the Profile
resource "archestra_profile_tool" "whoami" {
  profile_id = archestra_profile.demo_profile.id
  tool_id    = data.archestra_profile_tool.whoami.tool_id

  # Configuration Options
  tool_result_treatment                      = "trusted"
  allow_usage_when_untrusted_data_is_present = true

  # Dynamic team credentials can be toggled
  use_dynamic_team_credential = false

  # Optional: modify the tool response before it reaches the model
  response_modifier_template = "This is a modified response: {{.Result}}"
}

# =============================================================================
# Example 2: Assign an MCP Server tool with credentials configuration
# =============================================================================

# Create an MCP Server definition
resource "archestra_mcp_server" "filesystem" {
  name        = "filesystem-mcp-server"
  description = "MCP server for filesystem operations"
  docs_url    = "https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem"

  local_config = {
    command   = "npx"
    arguments = ["-y", "@modelcontextprotocol/server-filesystem", "./"]
  }
}

# Install the MCP server
resource "archestra_mcp_server_installation" "filesystem" {
  name          = "my-filesystem-server"
  mcp_server_id = archestra_mcp_server.filesystem.id
}

# Look up a tool from the installed MCP server
data "archestra_mcp_server_tool" "read_text_file" {
  mcp_server_id = archestra_mcp_server_installation.filesystem.id
  name          = "${archestra_mcp_server.filesystem.name}__read_text_file"
  depends_on    = [archestra_mcp_server_installation.filesystem]
}

# Assign the MCP tool to the profile with full configuration
resource "archestra_profile_tool" "read_text_file" {
  profile_id = archestra_profile.demo_profile.id
  tool_id    = data.archestra_mcp_server_tool.read_text_file.id

  # Specify which MCP server provides credentials
  credential_source_mcp_server_id = archestra_mcp_server_installation.filesystem.id

  # Specify which MCP server executes the tool
  execution_source_mcp_server_id = archestra_mcp_server_installation.filesystem.id

  # Use dynamic team credentials instead of user-specific credentials
  use_dynamic_team_credential = false

  # Allow tool usage even when untrusted data is present in the context
  allow_usage_when_untrusted_data_is_present = true

  # How to treat tool results: "trusted", "untrusted", or "sanitize_with_dual_llm"
  tool_result_treatment = "trusted"

  # Optional: Template to modify tool responses
  response_modifier_template = "File content: {{response}}"
}
```

<!-- schema generated by tfplugindocs -->

## Schema

### Required

- `profile_id` (String) The ID of the Profile to assign the tool to
- `tool_id` (String) The ID of the Tool to assign

### Optional

- `allow_usage_when_untrusted_data_is_present` (Boolean) Whether to allow tool usage when untrusted data is present
- `credential_source_mcp_server_id` (String) The ID of the MCP Server instance to use for credentials/authentication
- `execution_source_mcp_server_id` (String) The ID of the MCP Server instance to use for execution
- `response_modifier_template` (String) Template string to modify the tool response before it reaches the model
- `tool_result_treatment` (String) How to treat tool results (trusted, sanitize_with_dual_llm, untrusted)
- `use_dynamic_team_credential` (Boolean) If true, dynamically resolves credentials based on the team context at runtime

### Read-Only

- `id` (String) The unique identifier of the profile-tool assignment (Composite ID: profile_id:tool_id)
