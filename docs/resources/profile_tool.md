---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "archestra_profile_tool Resource - archestra"
subcategory: ""
description: |-
  Assigns an MCP tool to an Archestra profile (agent). This resource manages the relationship between a profile and a tool, including credential sources and execution settings.
---

# archestra_profile_tool (Resource)

Assigns an MCP tool to an Archestra profile (agent). This resource manages the relationship between a profile and a tool, including credential sources and execution settings.

## Example Usage

```terraform
# Example 1: Complete profile tool assignment with all options

# Look up an existing profile
data "archestra_profile" "default" {
  name = "Default Agent"
}

# Create or reference an MCP server
resource "archestra_mcp_server" "github" {
  name      = "github-server"
  transport = "stdio"
  command   = "npx"
  args      = ["-y", "@modelcontextprotocol/server-github"]

  environment = {
    GITHUB_PERSONAL_ACCESS_TOKEN = var.github_token
  }
}

# Look up a tool from the MCP server
data "archestra_mcp_server_tool" "github_create_issue" {
  mcp_server_id = archestra_mcp_server.github.id
  name          = "create_issue"
}

# Assign the tool to the profile with full configuration
resource "archestra_profile_tool" "github_create_issue" {
  profile_id = data.archestra_profile.default.id
  tool_id    = data.archestra_mcp_server_tool.github_create_issue.id

  # Specify which MCP server provides credentials (defaults to the tool's MCP server)
  credential_source_mcp_server_id = archestra_mcp_server.github.id

  # Specify which MCP server executes the tool (defaults to the tool's MCP server)
  execution_source_mcp_server_id = archestra_mcp_server.github.id

  # Use dynamic team credentials instead of user-specific credentials
  use_dynamic_team_credential = false

  # Allow tool usage even when untrusted data is present in the context
  allow_usage_when_untrusted_data_is_present = true

  # How to treat tool results: "trusted", "untrusted", or "sanitize_with_dual_llm"
  tool_result_treatment = "trusted"

  # Optional: Template to modify tool responses
  response_modifier_template = "Issue created: {{response}}"
}

# Example 2: Minimal profile tool assignment
resource "archestra_profile_tool" "minimal" {
  profile_id = data.archestra_profile.default.id
  tool_id    = data.archestra_mcp_server_tool.github_create_issue.id

  # All other fields will use defaults:
  # - credential_source_mcp_server_id: tool's MCP server
  # - execution_source_mcp_server_id: tool's MCP server
  # - use_dynamic_team_credential: false
  # - allow_usage_when_untrusted_data_is_present: true
  # - tool_result_treatment: "trusted"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `profile_id` (String) The profile (agent) ID to assign the tool to
- `tool_id` (String) The tool ID to assign (from archestra_mcp_server_tool data source)

### Optional

- `allow_usage_when_untrusted_data_is_present` (Boolean) Whether to allow tool usage when untrusted data is present. Defaults to true.
- `credential_source_mcp_server_id` (String) The MCP server ID to use as the credential source. If not specified, defaults to the tool's MCP server.
- `execution_source_mcp_server_id` (String) The MCP server ID to use for tool execution. If not specified, defaults to the tool's MCP server.
- `response_modifier_template` (String) Optional template to modify tool responses
- `tool_result_treatment` (String) How to treat tool results: 'trusted', 'untrusted', or 'sanitize_with_dual_llm'. Defaults to 'trusted'.
- `use_dynamic_team_credential` (Boolean) Whether to use dynamic team credentials. Defaults to false.

### Read-Only

- `id` (String) Agent tool identifier (internal ID from API)

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
#!/bin/bash

# Import a profile tool assignment using the format: profile_id:tool_id
# Both IDs must be UUIDs

# Example with placeholder UUIDs (replace with your actual IDs)
terraform import archestra_profile_tool.github_create_issue "123e4567-e89b-12d3-a456-426614174000:789e4567-e89b-12d3-a456-426614174111"

# To find the profile_id:
# terraform console
# > data.archestra_profile.default.id

# To find the tool_id:
# terraform console
# > data.archestra_mcp_server_tool.github_create_issue.id
```
